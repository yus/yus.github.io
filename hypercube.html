<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4D Hypercube Visualization</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            font-family: Arial, sans-serif;
            color: white;
        }
        
        #sketch-container {
            margin: 20px 0;
        }
        
        .controls {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px;
            max-width: 600px;
        }
        
        h1 {
            text-align: center;
            color: #fff;
            margin-bottom: 10px;
        }
        
        .instructions {
            text-align: center;
            margin-bottom: 20px;
            opacity: 0.8;
        }
        
        button {
            background: #4CAF50;
            border: none;
            color: white;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #45a049;
        }
        
        .slider-container {
            margin: 10px 0;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
        }
        
        input[type="range"] {
            width: 200px;
        }
    </style>
</head>
<body>
    <h1>4D Hypercube (Tesseract) Visualization</h1>
    
    <div class="instructions">
        <p>Drag to rotate in 3D â€¢ Use controls below to manipulate the 4D rotation</p>
    </div>
    
    <div id="sketch-container"></div>
    
    <div class="controls">
        <div class="slider-container">
            <label for="speed">Rotation Speed: <span id="speed-value">0.02</span></label>
            <input type="range" id="speed" min="0" max="0.1" step="0.001" value="0.02">
        </div>
        
        <div class="slider-container">
            <label for="size">Hypercube Size: <span id="size-value">100</span></label>
            <input type="range" id="size" min="50" max="200" step="10" value="100">
        </div>
        
        <div>
            <button id="toggle-rotation">Pause Rotation</button>
            <button id="reset-view">Reset View</button>
            <button id="toggle-vertices">Hide Vertices</button>
            <button id="toggle-wireframe">Wireframe Mode</button>
        </div>
        
        <div style="margin-top: 15px;">
            <p><strong>What you're seeing:</strong> This is a 3D projection of a 4-dimensional hypercube (tesseract). 
            The complex folding pattern represents how a 4D object would appear in our 3D space.</p>
        </div>
    </div>

    <script>
        let vertices = [];
        let edges = [];
        let angleW = 0;
        let rotate4D = true;
        let cubeSize = 100;
        let rotationSpeed = 0.02;
        let showVertices = true;
        let wireframeMode = false;

        function setup() {
            let canvas = createCanvas(700, 700, WEBGL);
            canvas.parent('sketch-container');
            createHypercube();
            
            // Setup event listeners
            document.getElementById('speed').addEventListener('input', function(e) {
                rotationSpeed = parseFloat(e.target.value);
                document.getElementById('speed-value').textContent = rotationSpeed.toFixed(3);
            });
            
            document.getElementById('size').addEventListener('input', function(e) {
                cubeSize = parseInt(e.target.value);
                document.getElementById('size-value').textContent = cubeSize;
                createHypercube();
            });
            
            document.getElementById('toggle-rotation').addEventListener('click', function() {
                rotate4D = !rotate4D;
                this.textContent = rotate4D ? 'Pause Rotation' : 'Resume Rotation';
            });
            
            document.getElementById('reset-view').addEventListener('click', function() {
                angleW = 0;
            });
            
            document.getElementById('toggle-vertices').addEventListener('click', function() {
                showVertices = !showVertices;
                this.textContent = showVertices ? 'Hide Vertices' : 'Show Vertices';
            });
            
            document.getElementById('toggle-wireframe').addEventListener('click', function() {
                wireframeMode = !wireframeMode;
                this.textContent = wireframeMode ? 'Solid Mode' : 'Wireframe Mode';
            });
        }

        function createHypercube() {
            vertices = [];
            edges = [];
            
            // Create 16 vertices
            for (let i = 0; i < 16; i++) {
                vertices.push([
                    (i & 1) ? cubeSize : -cubeSize,
                    (i & 2) ? cubeSize : -cubeSize,
                    (i & 4) ? cubeSize : -cubeSize,
                    (i & 8) ? cubeSize : -cubeSize
                ]);
            }
            
            // Create 32 edges
            for (let i = 0; i < 16; i++) {
                for (let j = i + 1; j < 16; j++) {
                    if (countDifferences(i, j) === 1) {
                        edges.push([i, j]);
                    }
                }
            }
        }

        function countDifferences(a, b) {
            let diff = 0;
            for (let k = 0; k < 4; k++) {
                if (((a >> k) & 1) !== ((b >> k) & 1)) diff++;
            }
            return diff;
        }

        function draw() {
            background(0);
            
            // Enable 3D rotation with mouse
            orbitControl();
            
            // 4D rotation
            if (rotate4D) {
                angleW += rotationSpeed;
            }
            
            // Style based on mode
            if (wireframeMode) {
                noFill();
                stroke(255, 150);
                strokeWeight(1);
            } else {
                noFill();
                stroke(255);
                strokeWeight(2);
            }
            
            // Draw edges
            for (let [i, j] of edges) {
                let v1 = project4D(vertices[i]);
                let v2 = project4D(vertices[j]);
                
                // Depth-based coloring
                let depth = (v1[2] + v2[2]) / 2;
                let brightness = map(depth, -cubeSize*2, cubeSize*2, 100, 255);
                
                if (!wireframeMode) {
                    stroke(255, brightness);
                }
                
                line(v1[0], v1[1], v1[2], v2[0], v2[1], v2[2]);
            }
            
            // Draw vertices
            if (showVertices && !wireframeMode) {
                fill(255);
                noStroke();
                for (let vertex of vertices) {
                    let v = project4D(vertex);
                    push();
                    translate(v[0], v[1], v[2]);
                    sphere(3);
                    pop();
                }
            }
        }

        function project4D(v) {
            let [x, y, z, w] = v;
            
            // 4D rotation in XW plane
            let newX = x * cos(angleW) - w * sin(angleW);
            let newW = x * sin(angleW) + w * cos(angleW);
            
            // Perspective projection
            let scale = 400 / (500 - newW);
            return [newX * scale, y * scale, z * scale];
        }

        function windowResized() {
            resizeCanvas(700, 700);
        }
    </script>
</body>
</html>
