<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escher Reptiles - Working Version</title>
    <script src="https://cdnjs.cloudflare.com/p5.js/1.7.0/p5.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background-color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, sans-serif;
        }
        @media (max-width: 768px) {
            .container {
            width: 100%;
            }
        }
        h1 {
            color: #000;
            margin-bottom: 10px;
        }
        .controls {
            margin: 20px 0;
            display: flex;
            gap: 20px;
        }
        button {
            padding: 8px 16px;
            background: #000;
            color: white;
            border: none;
            cursor: pointer;
        }
        canvas {
            border: 2px solid #000;
            display: block;
        }
        img {
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body>
    <h1>Escher's Reptiles Pattern</h1>
    <div class="controls">
        <button id="regenerate">New Pattern</button>
        <button id="invert">Invert Colors</button>
    </div>

    <script>
        let isInverted = false;
        
        function setup() {
            // Create canvas - using fixed size for reliability
            const canvas = createCanvas(800, 600);
            canvas.parent('body');
            canvas.style('display', 'block');
            canvas.style('margin', '20px auto');
            canvas.style('border', '2px solid #000');
            
            noLoop(); // Don't continuously redraw
            
            // Set up button events
            document.getElementById('regenerate').onclick = drawPattern;
            document.getElementById('invert').onclick = function() {
                isInverted = !isInverted;
                drawPattern();
            };
            
            // Initial draw
            drawPattern();
        }
        
        function drawPattern() {
            console.log("Drawing pattern..."); // Debug log
            
            // Clear canvas with appropriate background
            if (isInverted) {
                background(0); // Black background
                stroke(255);   // White lines
                fill(0);       // Black fill
            } else {
                background(255); // White background  
                stroke(0);      // Black lines
                fill(255);      // White fill
            }
            
            strokeWeight(2);
            
            // Simple grid parameters
            const size = 35;
            const cols = 8;
            const rows = 6;
            
            // Draw the tessellation pattern
            for (let x = 0; x < cols; x++) {
                for (let y = 0; y < rows; y++) {
                    push(); // Save current transformation state
                    
                    // Calculate position with offset for interlocking pattern
                    const xPos = 50 + x * size * 2.5;
                    const yPos = 50 + y * size * 2;
                    
                    // Alternate rows are offset for tessellation
                    if (y % 2 === 0) {
                        translate(xPos, yPos);
                    } else {
                        translate(xPos + size * 1.25, yPos);
                    }
                    
                    drawReptile(size);
                    pop(); // Restore transformation state
                }
            }
        }
        
        function drawReptile(size) {
            // Draw a simple lizard shape
            
            // Body (main oval)
            beginShape();
            vertex(0, -size * 0.4);
            vertex(size * 0.6, -size * 0.2);
            vertex(size * 0.8, 0);
            vertex(size * 0.6, size * 0.2);
            vertex(0, size * 0.4);
            vertex(-size * 0.6, size * 0.2);
            vertex(-size * 0.8, 0);
            vertex(-size * 0.6, -size * 0.2);
            endShape(CLOSE);
            
            // Head
            beginShape();
            vertex(size * 0.8, -size * 0.1);
            vertex(size * 1.2, -size * 0.05);
            vertex(size * 1.3, 0);
            vertex(size * 1.2, size * 0.05);
            vertex(size * 0.8, size * 0.1);
            endShape(CLOSE);
            
            // Tail
            beginShape();
            vertex(-size * 0.8, -size * 0.05);
            vertex(-size * 1.4, -size * 0.1);
            vertex(-size * 1.6, 0);
            vertex(-size * 1.4, size * 0.1);
            vertex(-size * 0.8, size * 0.05);
            endShape(CLOSE);
            
            // Legs - simpler approach
            strokeWeight(size/5);
            line(size * 0.3, -size * 0.2, size * 0.5, -size * 0.4);
            line(size * 0.1, -size * 0.3, size * 0.3, -size * 0.5);
            line(size * 0.3, size * 0.2, size * 0.5, size * 0.4);
            line(size * 0.1, size * 0.3, size * 0.3, size * 0.5);
            
            // Eye
            strokeWeight(1);
            if (isInverted) {
                fill(255);
            } else {
                fill(0);
            }
            ellipse(size * 1.1, 0, size/8, size/8);
        }
        
        // p5.js will automatically call setup() when ready
    </script>
</body>
</html>