<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/2.0.4/p5.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: #222;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: 'Arial', sans-serif;
        }
        canvas {
            border-radius: 4px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        .title {
            position: absolute;
            top: 20px;
            color: white;
            text-align: center;
            font-size: 24px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
            z-index: 10;
        }
        .controls {
            position: absolute;
            bottom: 20px;
            color: #ccc;
            text-align: center;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px 20px;
            border-radius: 10px;
            z-index: 10;
        }
    </style>
</head>
<body>
    <div class="title">Wireframe Cube Grid</div>
    <div class="controls">
        <p>Click and drag to orbit | Press 'f' to toggle auto-rotation</p>
    </div>
    <script>
        // Rotation variables
        let angleX = 0;
        let angleY = 0;
        let angleZ = 0;
        let rotationSpeed = 0.01;
        let autoRotate = true;

        // Cube parameters
        let cubeSize = 200;
        let gridSize = 10; // 10x10 grid
        let cellSize = cubeSize / gridSize;
        let spacing = 2; // Space between cells

        // Geometry objects
        let cellGeometry;

        function setup() {
            createCanvas(windowWidth * 0.9, windowHeight * 0.9, WEBGL);
            angleMode(RADIANS);

            // Create cell geometry
            cellGeometry = new p5.Geometry();
            createCellGeometry(cellGeometry);
            cellGeometry.computeFaces();
            cellGeometry.computeNormals();
        }

        function createCellGeometry(geom) {
            // Create geometry for a wireframe cell
            let size = cellSize - spacing;
            let halfSize = size / 2;

            // Define vertices for the cell
            let vertices = [
                // Front face
                createVector(-halfSize, -halfSize, halfSize),
                createVector(halfSize, -halfSize, halfSize),
                createVector(halfSize, halfSize, halfSize),
                createVector(-halfSize, halfSize, halfSize),

                // Back face
                createVector(-halfSize, -halfSize, -halfSize),
                createVector(halfSize, -halfSize, -halfSize),
                createVector(halfSize, halfSize, -halfSize),
                createVector(-halfSize, halfSize, -halfSize)
            ];

            // Add vertices to geometry
            for (let v of vertices) {
                geom.vertices.push(v);
            }

            // Define edges (wireframe)
            geom.edges = [
                // Front face edges
                [0, 1], [1, 2], [2, 3], [3, 0],
                // Back face edges
                [4, 5], [5, 6], [6, 7], [7, 4],
                // Connecting edges
                [0, 4], [1, 5], [2, 6], [3, 7]
            ];
        }

        function draw() {
            // Clear with dark gray background
            background(40);

            // Enable orbit controls
            orbitControl(1, 1, 0.1);

            // Apply auto-rotation if enabled
            if (autoRotate) {
                angleX += rotationSpeed * 0.7;
                angleY += rotationSpeed * 1.2;
                angleZ += rotationSpeed * 0.5;

                rotateX(angleX);
                rotateY(angleY);
                rotateZ(angleZ);
            }

            // Set wireframe style
            stroke(200, 200, 255);
            strokeWeight(1.2);
            noFill();

            // Draw the cube with 10x10 grid on each face
            drawCube();
        }

        function drawCube() {
            push();

            // Draw each face of the cube
            for (let face = 0; face < 6; face++) {
                push();

                // Position and rotate for each face
                switch(face) {
                    case 0: // Front
                        translate(0, 0, cubeSize/2);
                        break;
                    case 1: // Back
                        translate(0, 0, -cubeSize/2);
                        rotateY(PI);
                        break;
                    case 2: // Right
                        translate(cubeSize/2, 0, 0);
                        rotateY(HALF_PI);
                        break;
                    case 3: // Left
                        translate(-cubeSize/2, 0, 0);
                        rotateY(-HALF_PI);
                        break;
                    case 4: // Top
                        translate(0, -cubeSize/2, 0);
                        rotateX(HALF_PI);
                        break;
                    case 5: // Bottom
                        translate(0, cubeSize/2, 0);
                        rotateX(-HALF_PI);
                        break;
                }

                // Draw grid for this face
                drawGrid(face);

                pop();
            }

            pop();
        }

        function drawGrid(face) {
            // Draw the 10x10 grid on the face
            let halfCube = cubeSize / 2;
            let halfCell = cellSize / 2;

            for (let i = 0; i < gridSize; i++) {
                for (let j = 0; j < gridSize; j++) {
                    let x = -halfCube + (i * cellSize) + halfCell;
                    let y = -halfCube + (j * cellSize) + halfCell;

                    push();
                    translate(x, y, 0);

                    // Draw the cell
                    model(cellGeometry);
                    // Free geometry immediately after drawing
                    freeGeometry(cellGeometry);

                    pop();
                }
            }
        }

        function keyPressed() {
            // Press 'f' to toggle auto-rotation
            if (key === 'f' || key === 'F') {
                autoRotate = !autoRotate;
                return false;
            }
        }

        function windowResized() {
            resizeCanvas(windowWidth * 0.9, windowHeight * 0.9);
        }
    </script>
</body>
</html>
